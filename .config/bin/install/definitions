#!/bin/bash

termwidth=80
PKG_BUILD_DIR="$HOME/Code/Packages"
BLUE="\033[34m"
MAGENTA="\033[35m"
RED="\033[31m"
YELLOW="\033[33m"
GREEN="\033[32m"
BOLD="\033[1m"
RESET_FMT="\033[0m"

# trap 'last_command=$current_command; current_command=$BASH_COMMAND' DEBUG
# trap handle_exit EXIT

case $1 in
    '--update')
        FRESH_INSTALL=false
        ;;
    * )
        FRESH_INSTALL=true
        ;;
esac

# function handle_exit {
#     if [ "$?" -eq 0 ]; then
#         echo -e "Clean exit"
#     elif [ "$?" -eq 196238 ]; then
#         echo -e "User aborted script"
#     else
#         echo -e "${BOLD}====>${RESET_FMT} \`${last_command}\` ${RED}${BOLD}failed with exit code $?, aborting install...${RESET_FMT}"
#     fi
# }

function header {
	echo -e "${BOLD}====> ${BLUE}$1${RESET_FMT}"
}

function section {
    echo ""
    title=$(echo "$3"| tr a-z A-Z)
    text="PART $1/$2: $title"
    padding="$(printf '%0.1s' -{1..500})"
    printf "%*.*s ${BOLD}${MAGENTA}%s${RESET_FMT} %*.*s\n" 0 "$(((termwidth-2-${#text})/2))" "$padding" "$text" 0 "$(((termwidth-1-${#text})/2))" "$padding"
    echo ""
}

function warn {
	echo -e "${BOLD}   -> ${YELLOW}Warning: $1${RESET_FMT}"
}

function confirm {
    echo -en "${BOLD}====> ${GREEN}$1${RESET_FMT}"
    while true; do
        read -n1 -p " (y/n/e) " yn
        case $yn in
            [Yy]* ) echo "" && return 0;;
            [Nn]* ) echo "" && return 1;;
            [Ee]* ) echo "" && echo "" && warn "user aborted script, exiting..." && exit 1;;
            * ) echo -e "\nPlease answer yes or no.";;
        esac
    done
}
