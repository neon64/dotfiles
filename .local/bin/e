#!/usr/bin/env bash

# this technique modified from https://www.reddit.com/r/emacs/comments/a5uzeb/how_can_emacsclient_create_a_new_frame_when_none/
#
# find all existing frames
frameslist=$(emacsclient -a "" --eval '(frame-list)' 2>/dev/null | grep -E -o '(frame)+' | wc -l)

if [ "$frameslist" -ge 2 ]; then
    echo "opening in existing frame..."
    # prevent creating another X frame if there is at least one present.
    emacsclient -a "" -n "$@"
else
    echo "opening in existing frame..."
    # Create one if there is no X window yet.
    emacsclient -a "" -c -n "$@"
fi
